<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SMS Analysis - SMS Shield</title>
  <link rel="stylesheet" href="enhanced-design.css">
  <link rel="stylesheet" href="all.min.css">
  <link rel="manifest" href="manifest.json">
  <link rel="icon" type="image/svg+xml" href="favicon.svg">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Poppins:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  
  <style>
    .analysis-container {
      max-width: 800px;
      margin: 0 auto;
      padding: 2rem 1.5rem;
    }

    .analysis-form {
      background: var(--glass-bg);
      backdrop-filter: blur(20px);
      border: 1px solid var(--glass-border);
      border-radius: var(--radius-xl);
      padding: var(--space-2xl);
      box-shadow: var(--glass-shadow);
      margin-bottom: var(--space-xl);
    }

    .form-group {
      margin-bottom: var(--space-lg);
    }

    .form-label {
      display: block;
      font-weight: 600;
      color: white;
      margin-bottom: var(--space-sm);
      font-size: 1.1rem;
    }

    .sms-textarea {
      width: 100%;
      min-height: 120px;
      padding: var(--space-md);
      border: 2px solid var(--glass-border);
      border-radius: var(--radius-lg);
      background: rgba(255, 255, 255, 0.1);
      backdrop-filter: blur(10px);
      color: white;
      font-family: var(--font-primary);
      font-size: 1rem;
      resize: vertical;
      transition: all var(--transition-normal);
    }

    .sms-textarea:focus {
      outline: none;
      border-color: var(--primary-color);
      box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
      background: rgba(255, 255, 255, 0.15);
    }

    .sms-textarea::placeholder {
      color: rgba(255, 255, 255, 0.6);
    }

    .analysis-actions {
      display: flex;
      gap: var(--space-md);
      justify-content: center;
      flex-wrap: wrap;
    }

    .result-container {
      background: var(--glass-bg);
      backdrop-filter: blur(20px);
      border: 1px solid var(--glass-border);
      border-radius: var(--radius-xl);
      padding: var(--space-2xl);
      box-shadow: var(--glass-shadow);
      margin-top: var(--space-xl);
      display: none;
    }

    .result-container.show {
      display: block;
      animation: slideInUp 0.6s ease-out;
    }

    .threat-indicator {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: var(--space-md);
      margin-bottom: var(--space-xl);
      padding: var(--space-lg);
      border-radius: var(--radius-lg);
      font-size: 1.5rem;
      font-weight: 700;
      text-align: center;
    }

    .threat-safe {
      background: var(--gradient-success);
      color: white;
    }

    .threat-warning {
      background: var(--gradient-danger);
      color: white;
    }

    .confidence-display {
      background: rgba(255, 255, 255, 0.1);
      border-radius: var(--radius-lg);
      padding: var(--space-lg);
      margin-bottom: var(--space-xl);
    }

    .confidence-bar-container {
      width: 100%;
      height: 8px;
      background: rgba(255, 255, 255, 0.2);
      border-radius: var(--radius-full);
      overflow: hidden;
      margin: var(--space-sm) 0;
    }

    .confidence-bar {
      height: 100%;
      background: var(--gradient-accent);
      border-radius: var(--radius-full);
      transition: width 1s ease-out;
      position: relative;
    }

    .confidence-bar::after {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
      animation: shimmer 2s infinite;
    }

    .indicators-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: var(--space-md);
      margin: var(--space-xl) 0;
    }

    .indicator-card {
      background: rgba(255, 255, 255, 0.1);
      border-radius: var(--radius-lg);
      padding: var(--space-md);
      border-left: 4px solid var(--accent-color);
    }

    .recommendations-list {
      list-style: none;
      padding: 0;
    }

    .recommendation-item {
      display: flex;
      align-items: flex-start;
      gap: var(--space-sm);
      padding: var(--space-sm) 0;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    }

    .recommendation-item:last-child {
      border-bottom: none;
    }

    .quick-examples {
      margin-top: var(--space-2xl);
    }

    .examples-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: var(--space-md);
      margin-top: var(--space-lg);
    }

    .example-card {
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: var(--radius-lg);
      padding: var(--space-lg);
      cursor: pointer;
      transition: all var(--transition-normal);
    }

    .example-card:hover {
      background: rgba(255, 255, 255, 0.1);
      border-color: var(--primary-color);
      transform: translateY(-2px);
    }

    .example-label {
      font-weight: 600;
      color: white;
      margin-bottom: var(--space-sm);
      display: flex;
      align-items: center;
      gap: var(--space-sm);
    }

    .example-text {
      font-size: 0.9rem;
      opacity: 0.8;
      line-height: 1.4;
    }

    .loading-overlay {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.5);
      backdrop-filter: blur(5px);
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: var(--radius-xl);
      z-index: 10;
    }

    .loading-spinner {
      width: 60px;
      height: 60px;
      border: 4px solid rgba(255, 255, 255, 0.2);
      border-top: 4px solid var(--primary-color);
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
  </style>
</head>
<body>
  <!-- Enhanced Theme Toggle -->
  <button class="theme-toggle-enhanced" onclick="toggleTheme()" aria-label="Toggle theme">
    üåô
  </button>

  <!-- Enhanced Header -->
  <header class="enhanced-header">
    <div class="header-content">
      <div class="logo-section">
        <div class="logo-icon">üõ°Ô∏è</div>
        <a href="index.html" class="logo-text">SMS Shield</a>
      </div>
      
      <nav class="enhanced-nav">
        <a href="index.html" class="nav-link">Home</a>
        <a href="detect.html" class="nav-link" style="background: var(--gradient-primary); color: white;">Detect</a>
        <a href="dashboard.html" class="nav-link">Dashboard</a>
        <a href="about.html" class="nav-link">About</a>
        <a href="contact.html" class="nav-link">Contact</a>
        <a href="login.html" class="nav-link">Login</a>
      </nav>
    </div>
  </header>

  <!-- Main Analysis Container -->
  <div class="analysis-container" style="margin-top: 120px;">
    <div style="text-align: center; margin-bottom: 3rem;">
      <h1 style="font-size: 3rem; margin-bottom: 1rem; background: linear-gradient(135deg, #fff, #f0f0f0); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;">
        üîç SMS Analysis Center
      </h1>
      <p style="font-size: 1.2rem; opacity: 0.9; max-width: 600px; margin: 0 auto;">
        Paste your SMS message below for instant AI-powered phishing detection and analysis
      </p>
    </div>

    <!-- Analysis Form -->
    <div class="analysis-form">
      <div class="form-group">
        <label for="smsInput" class="form-label">
          üì± SMS Message Content
        </label>
        <textarea 
          id="smsInput" 
          class="sms-textarea" 
          placeholder="Paste your SMS message here for analysis...

Example:
'URGENT: Your bank account has been suspended! Click here to verify: bit.ly/fake-bank'"
          rows="6"
        ></textarea>
      </div>

      <div class="analysis-actions">
        <button onclick="analyzeSMSMessage()" class="btn-enhanced btn-primary">
          <i class="fas fa-search"></i>
          Analyze Message
        </button>
        <button onclick="clearAnalysis()" class="btn-enhanced btn-secondary">
          <i class="fas fa-eraser"></i>
          Clear
        </button>
      </div>
    </div>

    <!-- Results Container -->
    <div id="result" class="result-container">
      <div class="loading-overlay" id="loadingOverlay" style="display: none;">
        <div style="text-align: center; color: white;">
          <div class="loading-spinner"></div>
          <p style="margin-top: 1rem; font-weight: 600;">Analyzing message...</p>
          <p style="font-size: 0.9rem; opacity: 0.8;">Running AI models and threat detection</p>
        </div>
      </div>
      <!-- Results will be populated here -->
    </div>

    <!-- Quick Examples -->
    <div class="quick-examples">
      <h3 style="text-align: center; margin-bottom: 1.5rem; color: white;">
        Quick Test Examples
      </h3>
      <div class="examples-grid">
        <div class="example-card" onclick="loadExample('phishing')">
          <div class="example-label">
            üö® Phishing Example
          </div>
          <div class="example-text">
            "URGENT: Your bank account has been SUSPENDED! Click here to verify: bit.ly/fake-bank"
          </div>
        </div>
        
        <div class="example-card" onclick="loadExample('safe')">
          <div class="example-label">
            ‚úÖ Safe Example
          </div>
          <div class="example-text">
            "Hi John, can we meet for coffee tomorrow at 3 PM? Let me know if that works for you."
          </div>
        </div>
        
        <div class="example-card" onclick="loadExample('suspicious')">
          <div class="example-label">
            ‚ö†Ô∏è Suspicious Example
          </div>
          <div class="example-text">
            "You have inherited $500,000! Contact lawyer immediately for transfer. Reply CLAIM to proceed."
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Scripts -->
  <script src="script.js"></script>
  <script src="darkMode.js"></script>
  <script>
    // Enhanced theme toggle
    function toggleTheme() {
      document.body.classList.toggle('dark-mode');
      const themeToggle = document.querySelector('.theme-toggle-enhanced');
      const isDark = document.body.classList.contains('dark-mode');
      themeToggle.textContent = isDark ? '‚òÄÔ∏è' : 'üåô';
      localStorage.setItem('darkMode', isDark);
    }

    // Load saved theme
    window.addEventListener('DOMContentLoaded', () => {
      const savedTheme = localStorage.getItem('darkMode');
      if (savedTheme === 'true') {
        document.body.classList.add('dark-mode');
        document.querySelector('.theme-toggle-enhanced').textContent = '‚òÄÔ∏è';
      }
    });

    // Enhanced SMS analysis function
    async function analyzeSMSMessage() {
      const smsInput = document.getElementById('smsInput');
      const resultContainer = document.getElementById('result');
      const loadingOverlay = document.getElementById('loadingOverlay');
      
      const smsContent = smsInput.value.trim();
      
      if (!smsContent) {
        showNotification('Please enter an SMS message to analyze', 'warning');
        return;
      }
      
      // Show loading state
      resultContainer.classList.add('show');
      loadingOverlay.style.display = 'flex';
      
      try {
        // Simulate analysis delay for better UX
        await new Promise(resolve => setTimeout(resolve, 2000));
        
        // Use the existing analyzeSMS function if available
        let analysis;
        if (typeof analyzeSMS === 'function') {
          analysis = await analyzeSMS(smsContent);
        } else {
          // Fallback simple analysis
          analysis = performBasicAnalysis(smsContent);
        }
        
        displayResults(analysis);
        
      } catch (error) {
        console.error('Analysis error:', error);
        showNotification('Error analyzing message. Please try again.', 'error');
      } finally {
        loadingOverlay.style.display = 'none';
      }
    }

    // Basic analysis fallback
    function performBasicAnalysis(text) {
      const phishingKeywords = ['urgent', 'suspended', 'click here', 'verify', 'winner', 'claim', 'prize', 'bitcoin'];
      const suspiciousPatterns = /bit\.ly|tinyurl|click.*here|verify.*account|suspended.*account/i;
      
      let score = 0;
      let indicators = [];
      
      // Check for phishing keywords
      phishingKeywords.forEach(keyword => {
        if (text.toLowerCase().includes(keyword)) {
          score += 15;
          indicators.push(`Contains suspicious keyword: "${keyword}"`);
        }
      });
      
      // Check for suspicious patterns
      if (suspiciousPatterns.test(text)) {
        score += 25;
        indicators.push('Contains suspicious URL patterns');
      }
      
      // Check for excessive capitalization
      const capsRatio = (text.match(/[A-Z]/g) || []).length / text.length;
      if (capsRatio > 0.3) {
        score += 10;
        indicators.push('Excessive capitalization detected');
      }
      
      const isPhishing = score >= 30;
      const confidence = Math.min(score * 2, 100);
      
      return {
        isPhishing,
        score,
        confidence,
        indicators,
        riskLevel: score >= 50 ? 'High' : score >= 30 ? 'Medium' : 'Low',
        recommendations: isPhishing ? [
          'üö® This message appears suspicious',
          '‚ùå Do not click any links',
          '‚ùå Do not provide personal information',
          '‚úÖ Verify sender through official channels'
        ] : [
          '‚úÖ This message appears safe',
          '‚úÖ Standard caution still recommended'
        ]
      };
    }

    // Display analysis results
    function displayResults(analysis) {
      const resultContainer = document.getElementById('result');
      
      const threatClass = analysis.isPhishing ? 'threat-warning' : 'threat-safe';
      const threatIcon = analysis.isPhishing ? 'üö®' : '‚úÖ';
      const threatText = analysis.isPhishing ? 'POTENTIAL THREAT DETECTED' : 'MESSAGE APPEARS SAFE';
      
      const resultsHTML = `
        <div class="threat-indicator ${threatClass}">
          <span>${threatIcon}</span>
          <span>${threatText}</span>
        </div>
        
        <div class="confidence-display">
          <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.5rem;">
            <span style="font-weight: 600; color: white;">Confidence Level</span>
            <span style="font-size: 1.2rem; font-weight: 700; color: white;">${Math.round(analysis.confidence)}%</span>
          </div>
          <div class="confidence-bar-container">
            <div class="confidence-bar" style="width: ${analysis.confidence}%"></div>
          </div>
        </div>
        
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; margin: 2rem 0;">
          <div style="text-align: center; padding: 1rem; background: rgba(255, 255, 255, 0.1); border-radius: 0.75rem;">
            <div style="font-size: 2rem; font-weight: 700; color: ${analysis.isPhishing ? '#ef4444' : '#10b981'};">
              ${analysis.score}/100
            </div>
            <div style="opacity: 0.8;">Threat Score</div>
          </div>
          <div style="text-align: center; padding: 1rem; background: rgba(255, 255, 255, 0.1); border-radius: 0.75rem;">
            <div style="font-size: 2rem; font-weight: 700; color: #f59e0b;">
              ${analysis.riskLevel}
            </div>
            <div style="opacity: 0.8;">Risk Level</div>
          </div>
        </div>
        
        ${analysis.indicators.length > 0 ? `
          <div style="margin: 2rem 0;">
            <h4 style="color: white; margin-bottom: 1rem;">üîç Detection Indicators</h4>
            <div class="indicators-grid">
              ${analysis.indicators.map(indicator => `
                <div class="indicator-card">
                  <div style="font-size: 0.9rem; color: rgba(255, 255, 255, 0.9);">${indicator}</div>
                </div>
              `).join('')}
            </div>
          </div>
        ` : ''}
        
        <div style="margin: 2rem 0;">
          <h4 style="color: white; margin-bottom: 1rem;">üí° Recommendations</h4>
          <ul class="recommendations-list">
            ${analysis.recommendations.map(rec => `
              <li class="recommendation-item">
                <span style="color: white; opacity: 0.9;">${rec}</span>
              </li>
            `).join('')}
          </ul>
        </div>
      `;
      
      resultContainer.innerHTML = resultsHTML;
      resultContainer.scrollIntoView({ behavior: 'smooth', block: 'start' });
    }

    // Load example messages
    function loadExample(type) {
      const examples = {
        phishing: "URGENT: Your bank account has been SUSPENDED! Click here to verify: bit.ly/fake-bank",
        safe: "Hi John, can we meet for coffee tomorrow at 3 PM? Let me know if that works for you.",
        suspicious: "You have inherited $500,000! Contact lawyer immediately for transfer. Reply CLAIM to proceed."
      };
      
      document.getElementById('smsInput').value = examples[type];
      document.getElementById('smsInput').focus();
    }

    // Clear analysis
    function clearAnalysis() {
      document.getElementById('smsInput').value = '';
      document.getElementById('result').classList.remove('show');
    }

    // Simple notification system
    function showNotification(message, type = 'info') {
      const notification = document.createElement('div');
      notification.style.cssText = `
        position: fixed;
        top: 20px;
        right: 20px;
        background: ${type === 'error' ? '#ef4444' : type === 'warning' ? '#f59e0b' : '#10b981'};
        color: white;
        padding: 1rem 1.5rem;
        border-radius: 0.5rem;
        box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
        z-index: 1000;
        animation: slideInRight 0.3s ease-out;
      `;
      notification.textContent = message;
      
      document.body.appendChild(notification);
      
      setTimeout(() => {
        notification.remove();
      }, 3000);
    }

    // Handle mobile menu if needed
    const handleMobileMenu = () => {
      const nav = document.querySelector('.enhanced-nav');
      if (window.innerWidth <= 768) {
        nav.style.display = 'none';
      } else {
        nav.style.display = 'flex';
      }
    };

    window.addEventListener('resize', handleMobileMenu);
    handleMobileMenu();
  </script>
</body>
</html>
